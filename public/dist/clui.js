var clui=function(t){"use strict";function e(){}function n(t){return t()}function r(){return Object.create(null)}function s(t){t.forEach(n)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e}let c,a=!1;function h(t,e,n,r){for(;t<e;){const s=t+(e-t>>1);n(s)<=r?t=s+1:e=s}return t}function l(t,e){a?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let s=0;for(let t=0;t<e.length;t++){const i=h(1,s+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[i]+1;const o=i+1;n[o]=t,s=Math.max(o,s)}const i=[],o=[];let c=e.length-1;for(let t=n[s]+1;0!=t;t=r[t-1]){for(i.push(e[t-1]);c>=t;c--)o.push(e[c]);c--}for(;c>=0;c--)o.push(e[c]);i.reverse(),o.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<o.length;e++){for(;n<i.length&&o[e].claim_order>=i[n].claim_order;)n++;const r=n<i.length?i[n]:null;t.insertBefore(o[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function u(t,e,n){a&&!n?l(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function m(){return g(" ")}function y(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function M(t,e){t.value=null==e?"":e}function b(t){const e={};for(const n of t)e[n.name]=n.value;return e}function w(t){c=t}const _=[],k=[],$=[],L=[],C=Promise.resolve();let E=!1;function A(t){$.push(t)}let S=!1;const I=new Set;function O(){if(!S){S=!0;do{for(let t=0;t<_.length;t+=1){const e=_[t];w(e),j(e.$$)}for(w(null),_.length=0;k.length;)k.pop()();for(let t=0;t<$.length;t+=1){const e=$[t];I.has(e)||(I.add(e),e())}$.length=0}while(_.length);for(;L.length;)L.pop()();E=!1,S=!1,I.clear()}}function j(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const F=new Set;function R(t,e){-1===t.$$.dirty[0]&&(_.push(t),E||(E=!0,C.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function N(t,o,h,l,u,f,p=[-1]){const g=c;w(t);const m=t.$$={fragment:null,ctx:null,props:f,update:e,not_equal:u,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(g?g.$$.context:o.context||[]),callbacks:r(),dirty:p,skip_bound:!1};let y=!1;if(m.ctx=h?h(t,o.props||{},((e,n,...r)=>{const s=r.length?r[0]:n;return m.ctx&&u(m.ctx[e],m.ctx[e]=s)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](s),y&&R(t,e)),n})):[],m.update(),y=!0,s(m.before_update),m.fragment=!!l&&l(m.ctx),o.target){if(o.hydrate){a=!0;const t=function(t){return Array.from(t.childNodes)}(o.target);m.fragment&&m.fragment.l(t),t.forEach(d)}else m.fragment&&m.fragment.c();o.intro&&((x=t.$$.fragment)&&x.i&&(F.delete(x),x.i(v))),function(t,e,r,o){const{fragment:c,on_mount:a,on_destroy:h,after_update:l}=t.$$;c&&c.m(e,r),o||A((()=>{const e=a.map(n).filter(i);h?h.push(...e):s(e),t.$$.on_mount=[]})),l.forEach(A)}(t,o.target,o.anchor,o.customElement),a=!1,O()}var x,v;w(g)}let q;"function"==typeof HTMLElement&&(q=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(n).filter(i);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){s(this.$$.on_disconnect)}$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});const z=[{name:"clui",description:"the main system (so meta)",type:"cmd",children:[{name:"help",description:"get help with the CLUI",type:"arg",children:[{name:"command",description:"the command to get help with",type:"string"}],run:(t,e)=>{e[0]}},{name:"config",description:"configure the CLUI",type:"arg",children:[{name:"option",description:"the option to configure",type:"string",required:!0},{name:"value",description:"the value to set",type:"string",required:!0}]}]}];
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function P(t,e,n,r){return new(n||(n=Promise))((function(s,i){function o(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,c)}a((r=r.apply(t,e||[])).next())}))}const T=t=>{if((t=new Rt(t,!1)).children&&"cmd"===t.type){let e=[];for(let n of t.children)e.push(T(n));t.children=e}else if(t.children&&"arg"===t.type){let e=[];for(let n of t.children)e.push(new Nt(n));t.children=e}return t};class B extends Array{}function K(t,e){const n=new B;let r=0;const s=()=>t.charAt(r),i=()=>t.charAt(r++),o=()=>""===s(),c=t=>{throw t},a=t=>/[a-z_]/i.test(t),h=t=>"-".indexOf(t)>=0,l=t=>"\"'".indexOf(t)>=0,u=t=>/[0-9]/.test(t),d=(t,r)=>{const{type:s,val:i}=Object.assign({},t);e&&void 0!==e.start?(void 0===e.end&&(e.end=e.start),n.push({type:s,val:i,cursor:r-i.length<=e.end&&r>=e.start})):n.push({type:s,val:i})},f=t=>{let e="";for(;!o()&&t(s());)e+=i();return e};for(;!o();){const t=i();if(" "!==t)if(a(t)){const e=t+f(a);"true false".indexOf(e)>=0?d({type:"boolean",val:Boolean(e)},r):d({type:"cmd",val:e},r)}else if(h(t)){const e=t+f(h);1===e.length?d({type:"opt",val:i()},r):2===e.length?d({type:"opt",val:f(a)},r):c(Error('too many recurring "-" in flag'))}else if(l(t))d({type:"string",val:f((e=>e!==t))},r),i();else if(u(t)){let e=!1;const n=t+f((t=>"."===t?(e&&c(Error('too many recurring "." in number')),e=!0,!0):u(t)));d({type:"number",val:Number(n)},r)}}return n}function U(t,e){var n;let r=[];if(t instanceof qt&&(t=new Rt({name:"h",type:"cmd",children:null!==(n=t.commands)&&void 0!==n?n:[]})),t instanceof Rt){let n,s=t;for(let t=0;t<e.length;t++){let i=e[t];if(!(s instanceof Rt&&s.type&&void 0!==s.children))return r;if("cmd"===s.type){let n=s.children.find((t=>t.name===i.val));if(!n)return r.push(...e.slice(t).map((t=>Object.assign(Object.assign({},t),{unknown:!0})))),r;s=n,r.push(s)}else"arg"===s.type&&(void 0===n&&(n=t),r.push(new Nt(Object.assign(Object.assign({},s.children[t-n]),{value:"opt"===i.type||i.val}))))}return r}throw new Error("Invalid root type (root has to be a Command)")}function W(t,e){var n;if("string"==typeof e&&(e=U(t,K(e))),t instanceof qt&&(t=new Rt({name:"h",type:"cmd",children:null!==(n=t.commands)&&void 0!==n?n:[]})),!(e[0]instanceof Rt||t instanceof Rt))return new Promise(((t,e)=>t({success:!1,output:"Error: Command not found"})));{let n=e.filter((t=>t instanceof Rt));const r=n.length>0?n[n.length-1]:t;let s=e.filter((t=>t instanceof Nt));if(r){let t=!0;if("arg"===r.type&&void 0!==r.children){let e=r.children.filter((t=>t.required)).length;t=e===s.filter((t=>t.required)).length}return new Promise(((e,n)=>{t||e({success:!1,output:"Error: Missing required arguments"});const i={command:r,done:(t,...n)=>{e({success:t,output:n})}};r.run?r.run(i,s):e({success:!1,output:"Error: Command has no run function"})}))}}}function H(t){return Array.isArray?Array.isArray(t):"[object Array]"===Y(t)}function J(t){return"string"==typeof t}function D(t){return"number"==typeof t}function V(t){return!0===t||!1===t||function(t){return Q(t)&&null!==t}(t)&&"[object Boolean]"==Y(t)}function Q(t){return"object"==typeof t}function G(t){return null!=t}function X(t){return!t.trim().length}function Y(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Z=Object.prototype.hasOwnProperty;class tt{constructor(t){this._keys=[],this._keyMap={};let e=0;t.forEach((t=>{let n=et(t);e+=n.weight,this._keys.push(n),this._keyMap[n.id]=n,e+=n.weight})),this._keys.forEach((t=>{t.weight/=e}))}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function et(t){let e=null,n=null,r=null,s=1;if(J(t)||H(t))r=t,e=nt(t),n=rt(t);else{if(!Z.call(t,"name"))throw new Error((t=>`Missing ${t} property in key`)("name"));const i=t.name;if(r=i,Z.call(t,"weight")&&(s=t.weight,s<=0))throw new Error((t=>`Property 'weight' in key '${t}' must be a positive integer`)(i));e=nt(i),n=rt(i)}return{path:e,id:n,weight:s,src:r}}function nt(t){return H(t)?t:t.split(".")}function rt(t){return H(t)?t.join("."):t}var st={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,...{useExtendedSearch:!1,getFn:function(t,e){let n=[],r=!1;const s=(t,e,i)=>{if(G(t))if(e[i]){const o=t[e[i]];if(!G(o))return;if(i===e.length-1&&(J(o)||D(o)||V(o)))n.push(function(t){return null==t?"":function(t){if("string"==typeof t)return t;let e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(t)}(o));else if(H(o)){r=!0;for(let t=0,n=o.length;t<n;t+=1)s(o[t],e,i+1)}else e.length&&s(o,e,i+1)}else n.push(t)};return s(t,J(e)?e.split("."):e,0),r?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1}};const it=/[^ ]+/g;class ot{constructor({getFn:t=st.getFn}={}){this.norm=function(t=3){const e=new Map,n=Math.pow(10,t);return{get(t){const r=t.match(it).length;if(e.has(r))return e.get(r);const s=1/Math.sqrt(r),i=parseFloat(Math.round(s*n)/n);return e.set(r,i),i},clear(){e.clear()}}}(3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach(((t,e)=>{this._keysMap[t.id]=e}))}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,J(this.docs[0])?this.docs.forEach(((t,e)=>{this._addString(t,e)})):this.docs.forEach(((t,e)=>{this._addObject(t,e)})),this.norm.clear())}add(t){const e=this.size();J(t)?this._addString(t,e):this._addObject(t,e)}removeAt(t){this.records.splice(t,1);for(let e=t,n=this.size();e<n;e+=1)this.records[e].i-=1}getValueForItemAtKeyId(t,e){return t[this._keysMap[e]]}size(){return this.records.length}_addString(t,e){if(!G(t)||X(t))return;let n={v:t,i:e,n:this.norm.get(t)};this.records.push(n)}_addObject(t,e){let n={i:e,$:{}};this.keys.forEach(((e,r)=>{let s=this.getFn(t,e.path);if(G(s))if(H(s)){let t=[];const e=[{nestedArrIndex:-1,value:s}];for(;e.length;){const{nestedArrIndex:n,value:r}=e.pop();if(G(r))if(J(r)&&!X(r)){let e={v:r,i:n,n:this.norm.get(r)};t.push(e)}else H(r)&&r.forEach(((t,n)=>{e.push({nestedArrIndex:n,value:t})}))}n.$[r]=t}else if(!X(s)){let t={v:s,n:this.norm.get(s)};n.$[r]=t}})),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function ct(t,e,{getFn:n=st.getFn}={}){const r=new ot({getFn:n});return r.setKeys(t.map(et)),r.setSources(e),r.create(),r}function at(t,{errors:e=0,currentLocation:n=0,expectedLocation:r=0,distance:s=st.distance,ignoreLocation:i=st.ignoreLocation}={}){const o=e/t.length;if(i)return o;const c=Math.abs(r-n);return s?o+c/s:c?1:o}const ht=32;function lt(t,e,n,{location:r=st.location,distance:s=st.distance,threshold:i=st.threshold,findAllMatches:o=st.findAllMatches,minMatchCharLength:c=st.minMatchCharLength,includeMatches:a=st.includeMatches,ignoreLocation:h=st.ignoreLocation}={}){if(e.length>ht)throw new Error(`Pattern length exceeds max of ${ht}.`);const l=e.length,u=t.length,d=Math.max(0,Math.min(r,u));let f=i,p=d;const g=c>1||a,m=g?Array(u):[];let y;for(;(y=t.indexOf(e,p))>-1;){let t=at(e,{currentLocation:y,expectedLocation:d,distance:s,ignoreLocation:h});if(f=Math.min(t,f),p=y+l,g){let t=0;for(;t<l;)m[y+t]=1,t+=1}}p=-1;let x=[],v=1,M=l+u;const b=1<<l-1;for(let r=0;r<l;r+=1){let i=0,c=M;for(;i<c;){at(e,{errors:r,currentLocation:d+c,expectedLocation:d,distance:s,ignoreLocation:h})<=f?i=c:M=c,c=Math.floor((M-i)/2+i)}M=c;let a=Math.max(1,d-c+1),y=o?u:Math.min(d+c,u)+l,w=Array(y+2);w[y+1]=(1<<r)-1;for(let i=y;i>=a;i-=1){let o=i-1,c=n[t.charAt(o)];if(g&&(m[o]=+!!c),w[i]=(w[i+1]<<1|1)&c,r&&(w[i]|=(x[i+1]|x[i])<<1|1|x[i+1]),w[i]&b&&(v=at(e,{errors:r,currentLocation:o,expectedLocation:d,distance:s,ignoreLocation:h}),v<=f)){if(f=v,p=o,p<=d)break;a=Math.max(1,2*d-p)}}if(at(e,{errors:r+1,currentLocation:d,expectedLocation:d,distance:s,ignoreLocation:h})>f)break;x=w}const w={isMatch:p>=0,score:Math.max(.001,v)};if(g){const t=function(t=[],e=st.minMatchCharLength){let n=[],r=-1,s=-1,i=0;for(let o=t.length;i<o;i+=1){let o=t[i];o&&-1===r?r=i:o||-1===r||(s=i-1,s-r+1>=e&&n.push([r,s]),r=-1)}return t[i-1]&&i-r>=e&&n.push([r,i-1]),n}(m,c);t.length?a&&(w.indices=t):w.isMatch=!1}return w}function ut(t){let e={};for(let n=0,r=t.length;n<r;n+=1){const s=t.charAt(n);e[s]=(e[s]||0)|1<<r-n-1}return e}class dt{constructor(t,{location:e=st.location,threshold:n=st.threshold,distance:r=st.distance,includeMatches:s=st.includeMatches,findAllMatches:i=st.findAllMatches,minMatchCharLength:o=st.minMatchCharLength,isCaseSensitive:c=st.isCaseSensitive,ignoreLocation:a=st.ignoreLocation}={}){if(this.options={location:e,threshold:n,distance:r,includeMatches:s,findAllMatches:i,minMatchCharLength:o,isCaseSensitive:c,ignoreLocation:a},this.pattern=c?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const h=(t,e)=>{this.chunks.push({pattern:t,alphabet:ut(t),startIndex:e})},l=this.pattern.length;if(l>ht){let t=0;const e=l%ht,n=l-e;for(;t<n;)h(this.pattern.substr(t,ht),t),t+=ht;if(e){const t=l-ht;h(this.pattern.substr(t),t)}}else h(this.pattern,0)}searchIn(t){const{isCaseSensitive:e,includeMatches:n}=this.options;if(e||(t=t.toLowerCase()),this.pattern===t){let e={isMatch:!0,score:0};return n&&(e.indices=[[0,t.length-1]]),e}const{location:r,distance:s,threshold:i,findAllMatches:o,minMatchCharLength:c,ignoreLocation:a}=this.options;let h=[],l=0,u=!1;this.chunks.forEach((({pattern:e,alphabet:d,startIndex:f})=>{const{isMatch:p,score:g,indices:m}=lt(t,e,d,{location:r+f,distance:s,threshold:i,findAllMatches:o,minMatchCharLength:c,includeMatches:n,ignoreLocation:a});p&&(u=!0),l+=g,p&&m&&(h=[...h,...m])}));let d={isMatch:u,score:u?l/this.chunks.length:1};return u&&n&&(d.indices=h),d}}class ft{constructor(t){this.pattern=t}static isMultiMatch(t){return pt(t,this.multiRegex)}static isSingleMatch(t){return pt(t,this.singleRegex)}search(){}}function pt(t,e){const n=t.match(e);return n?n[1]:null}class gt extends ft{constructor(t,{location:e=st.location,threshold:n=st.threshold,distance:r=st.distance,includeMatches:s=st.includeMatches,findAllMatches:i=st.findAllMatches,minMatchCharLength:o=st.minMatchCharLength,isCaseSensitive:c=st.isCaseSensitive,ignoreLocation:a=st.ignoreLocation}={}){super(t),this._bitapSearch=new dt(t,{location:e,threshold:n,distance:r,includeMatches:s,findAllMatches:i,minMatchCharLength:o,isCaseSensitive:c,ignoreLocation:a})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class mt extends ft{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let e,n=0;const r=[],s=this.pattern.length;for(;(e=t.indexOf(this.pattern,n))>-1;)n=e+s,r.push([e,n-1]);const i=!!r.length;return{isMatch:i,score:i?0:1,indices:r}}}const yt=[class extends ft{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},mt,class extends ft{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},class extends ft{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},class extends ft{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},class extends ft{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},class extends ft{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const e=-1===t.indexOf(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},gt],xt=yt.length,vt=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/;const Mt=new Set([gt.type,mt.type]);class bt{constructor(t,{isCaseSensitive:e=st.isCaseSensitive,includeMatches:n=st.includeMatches,minMatchCharLength:r=st.minMatchCharLength,ignoreLocation:s=st.ignoreLocation,findAllMatches:i=st.findAllMatches,location:o=st.location,threshold:c=st.threshold,distance:a=st.distance}={}){this.query=null,this.options={isCaseSensitive:e,includeMatches:n,minMatchCharLength:r,findAllMatches:i,ignoreLocation:s,location:o,threshold:c,distance:a},this.pattern=e?t:t.toLowerCase(),this.query=function(t,e={}){return t.split("|").map((t=>{let n=t.trim().split(vt).filter((t=>t&&!!t.trim())),r=[];for(let t=0,s=n.length;t<s;t+=1){const s=n[t];let i=!1,o=-1;for(;!i&&++o<xt;){const t=yt[o];let n=t.isMultiMatch(s);n&&(r.push(new t(n,e)),i=!0)}if(!i)for(o=-1;++o<xt;){const t=yt[o];let n=t.isSingleMatch(s);if(n){r.push(new t(n,e));break}}}return r}))}(this.pattern,this.options)}static condition(t,e){return e.useExtendedSearch}searchIn(t){const e=this.query;if(!e)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:r}=this.options;t=r?t:t.toLowerCase();let s=0,i=[],o=0;for(let r=0,c=e.length;r<c;r+=1){const c=e[r];i.length=0,s=0;for(let e=0,r=c.length;e<r;e+=1){const r=c[e],{isMatch:a,indices:h,score:l}=r.search(t);if(!a){o=0,s=0,i.length=0;break}if(s+=1,o+=l,n){const t=r.constructor.type;Mt.has(t)?i=[...i,...h]:i.push(h)}}if(s){let t={isMatch:!0,score:o/s};return n&&(t.indices=i),t}}return{isMatch:!1,score:1}}}const wt=[];function _t(t,e){for(let n=0,r=wt.length;n<r;n+=1){let r=wt[n];if(r.condition(t,e))return new r(t,e)}return new dt(t,e)}const kt="$and",$t="$or",Lt="$path",Ct="$val",Et=t=>!(!t[kt]&&!t[$t]),At=t=>({[kt]:Object.keys(t).map((e=>({[e]:t[e]})))});function St(t,e,{auto:n=!0}={}){const r=t=>{let s=Object.keys(t);const i=(t=>!!t[Lt])(t);if(!i&&s.length>1&&!Et(t))return r(At(t));if((t=>!H(t)&&Q(t)&&!Et(t))(t)){const r=i?t[Lt]:s[0],o=i?t[Ct]:t[r];if(!J(o))throw new Error((t=>`Invalid value for key ${t}`)(r));const c={keyId:rt(r),pattern:o};return n&&(c.searcher=_t(o,e)),c}let o={children:[],operator:s[0]};return s.forEach((e=>{const n=t[e];H(n)&&n.forEach((t=>{o.children.push(r(t))}))})),o};return Et(t)||(t=At(t)),r(t)}function It(t,e){const n=t.matches;e.matches=[],G(n)&&n.forEach((t=>{if(!G(t.indices)||!t.indices.length)return;const{indices:n,value:r}=t;let s={indices:n,value:r};t.key&&(s.key=t.key.src),t.idx>-1&&(s.refIndex=t.idx),e.matches.push(s)}))}function Ot(t,e){e.score=t.score}class jt{constructor(t,e={},n){this.options={...st,...e},this.options.useExtendedSearch,this._keyStore=new tt(this.options.keys),this.setCollection(t,n)}setCollection(t,e){if(this._docs=t,e&&!(e instanceof ot))throw new Error("Incorrect 'index' type");this._myIndex=e||ct(this.options.keys,this._docs,{getFn:this.options.getFn})}add(t){G(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=(()=>!1)){const e=[];for(let n=0,r=this._docs.length;n<r;n+=1){const s=this._docs[n];t(s,n)&&(this.removeAt(n),n-=1,r-=1,e.push(s))}return e}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:e=-1}={}){const{includeMatches:n,includeScore:r,shouldSort:s,sortFn:i,ignoreFieldNorm:o}=this.options;let c=J(t)?J(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return function(t,{ignoreFieldNorm:e=st.ignoreFieldNorm}){t.forEach((t=>{let n=1;t.matches.forEach((({key:t,norm:r,score:s})=>{const i=t?t.weight:null;n*=Math.pow(0===s&&i?Number.EPSILON:s,(i||1)*(e?1:r))})),t.score=n}))}(c,{ignoreFieldNorm:o}),s&&c.sort(i),D(e)&&e>-1&&(c=c.slice(0,e)),function(t,e,{includeMatches:n=st.includeMatches,includeScore:r=st.includeScore}={}){const s=[];return n&&s.push(It),r&&s.push(Ot),t.map((t=>{const{idx:n}=t,r={item:e[n],refIndex:n};return s.length&&s.forEach((e=>{e(t,r)})),r}))}(c,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(t){const e=_t(t,this.options),{records:n}=this._myIndex,r=[];return n.forEach((({v:t,i:n,n:s})=>{if(!G(t))return;const{isMatch:i,score:o,indices:c}=e.searchIn(t);i&&r.push({item:t,idx:n,matches:[{score:o,value:t,norm:s,indices:c}]})})),r}_searchLogical(t){const e=St(t,this.options),n=(t,e,r)=>{if(!t.children){const{keyId:n,searcher:s}=t,i=this._findMatches({key:this._keyStore.get(n),value:this._myIndex.getValueForItemAtKeyId(e,n),searcher:s});return i&&i.length?[{idx:r,item:e,matches:i}]:[]}switch(t.operator){case kt:{const s=[];for(let i=0,o=t.children.length;i<o;i+=1){const o=t.children[i],c=n(o,e,r);if(!c.length)return[];s.push(...c)}return s}case $t:{const s=[];for(let i=0,o=t.children.length;i<o;i+=1){const o=t.children[i],c=n(o,e,r);if(c.length){s.push(...c);break}}return s}}},r=this._myIndex.records,s={},i=[];return r.forEach((({$:t,i:r})=>{if(G(t)){let o=n(e,t,r);o.length&&(s[r]||(s[r]={idx:r,item:t,matches:[]},i.push(s[r])),o.forEach((({matches:t})=>{s[r].matches.push(...t)})))}})),i}_searchObjectList(t){const e=_t(t,this.options),{keys:n,records:r}=this._myIndex,s=[];return r.forEach((({$:t,i:r})=>{if(!G(t))return;let i=[];n.forEach(((n,r)=>{i.push(...this._findMatches({key:n,value:t[r],searcher:e}))})),i.length&&s.push({idx:r,item:t,matches:i})})),s}_findMatches({key:t,value:e,searcher:n}){if(!G(e))return[];let r=[];if(H(e))e.forEach((({v:e,i:s,n:i})=>{if(!G(e))return;const{isMatch:o,score:c,indices:a}=n.searchIn(e);o&&r.push({score:c,key:t,value:e,idx:s,norm:i,indices:a})}));else{const{v:s,n:i}=e,{isMatch:o,score:c,indices:a}=n.searchIn(s);o&&r.push({score:c,key:t,value:s,norm:i,indices:a})}return r}}function Ft(t,e,n){var r;let s;if(t instanceof qt&&!n)return t.fuse.search(e).map((t=>t.item));s=t instanceof qt?null!==(r=t.commands)&&void 0!==r?r:[]:"cmd"===t.type&&t.children?t.children:[];const i=(t,e=[])=>{let r=[];for(let s of t)e.push(s),n?r.push(new Rt(Object.assign(Object.assign({},s),{path:[...e]}))):r.push(s),"cmd"===s.type&&s.children&&(r=r.concat(i(s.children,e))),e.pop();return r};let o=i(s);return new jt(o,{keys:["name","description"]}).search(e).map((t=>t.item))}jt.version="6.4.6",jt.createIndex=ct,jt.parseIndex=function(t,{getFn:e=st.getFn}={}){const{keys:n,records:r}=t,s=new ot({getFn:e});return s.setKeys(n),s.setIndexRecords(r),s},jt.config=st,jt.parseQuery=St,function(...t){wt.push(...t)}(bt);class Rt{constructor(t,e=!0){e&&(t=T(t)),Object.keys(t).forEach((e=>{this[e]=t[e]}))}}class Nt{constructor(t){this.name=t.name,this.description=t.description,this.type=t.type,this.mode=t.mode,this.required=t.required,this.unknown=t.unknown,this.value=t.value}}class qt{constructor(){this.parse=K,this.match=U,this.run=W,this.search=Ft,this.parseMatch=(t,e)=>U(null!=e?e:this,K(t)),this.commands=[],this.fuse=new jt(this.commands),this.updateFuse=()=>{const t=e=>{let n=[];for(let r of e)n.push(r),"cmd"===r.type&&r.children&&(n=n.concat(t(r.children)));return n};let e=t(this.commands);this.fuse=new jt(e,{keys:["name","description"]})}}load(...t){for(let e of t)this.commands.push(new Rt(e));this.updateFuse()}loadURL(t){return P(this,void 0,void 0,(function*(){const e=(yield import(t)).default;if(Array.isArray(e))for(let t of e)this.commands.push(t);else this.commands.push(e);this.updateFuse()}))}getLastCommand(t){for(let e=t.length-1;e>=0;e--)if(t[e]instanceof Rt)return t[e]}stateful(t){var e;return void 0===t&&(t=new Rt({name:"h",type:"cmd",children:null!==(e=this.commands)&&void 0!==e?e:[]})),{parse:K,match:e=>U(t,e),run:e=>W(t,e),search:(e,n)=>Ft(t,e,n)}}}function zt(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function Pt(t,e,n){const r=t.slice();return r[20]=e[n],r}function Tt(t){let e,n,r=t[17].name+"";return{c(){e=p("span"),n=g(r),x(e,"class","item-name")},m(t,r){u(t,e,r),l(e,n)},p(t,e){2&e&&r!==(r=t[17].name+"")&&v(n,r)},d(t){t&&d(e)}}}function Bt(t){let e,n=t[17].path,r=[];for(let e=0;e<n.length;e+=1)r[e]=Kt(Pt(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=g("")},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);u(t,e,n)},p(t,s){if(2&s){let i;for(n=t[17].path,i=0;i<n.length;i+=1){const o=Pt(t,n,i);r[i]?r[i].p(o,s):(r[i]=Kt(o),r[i].c(),r[i].m(e.parentNode,e))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(t){f(r,t),t&&d(e)}}}function Kt(t){let e,n,r=t[20].name+"";return{c(){e=p("span"),n=g(r),x(e,"class","item-name")},m(t,r){u(t,e,r),l(e,n)},p(t,e){2&e&&r!==(r=t[20].name+"")&&v(n,r)},d(t){t&&d(e)}}}function Ut(t){let e,n,r,i,o,c,a,h,f=(t[17].description??"")+"";function M(t,e){return t[17].path&&t[17].path.length>0?Bt:Tt}let b=M(t),w=b(t);function _(){return t[11](t[19])}function k(){return t[12](t[17])}return{c(){e=p("div"),w.c(),n=m(),r=p("span"),i=g(f),o=m(),x(r,"class","item-description"),x(e,"class",c="dropdown-item "+(t[19]===t[2]?"selected":""))},m(t,s){u(t,e,s),w.m(e,null),l(e,n),l(e,r),l(r,i),l(e,o),a||(h=[y(e,"mouseover",_),y(e,"click",k)],a=!0)},p(r,s){b===(b=M(t=r))&&w?w.p(t,s):(w.d(1),w=b(t),w&&(w.c(),w.m(e,n))),2&s&&f!==(f=(t[17].description??"")+"")&&v(i,f),4&s&&c!==(c="dropdown-item "+(t[19]===t[2]?"selected":""))&&x(e,"class",c)},d(t){t&&d(e),w.d(),a=!1,s(h)}}}function Wt(t){let n,r,i,o,c,a,h,g,v,b,w,_,k,$=t[1],L=[];for(let e=0;e<$.length;e+=1)L[e]=Ut(zt(t,$,e));return{c(){n=p("div"),r=p("div"),i=p("div"),o=p("img"),a=m(),h=p("input"),g=m(),v=p("div");for(let t=0;t<L.length;t+=1)L[t].c();var t,s,l;b=m(),w=p("div"),this.c=e,o.src!==(c="fav.png")&&x(o,"src","fav.png"),x(o,"alt","icon"),x(o,"class","icon"),t="width",s="1.6rem",o.style.setProperty(t,s,l?"important":""),x(h,"type","text"),x(h,"placeholder","Enter a command"),x(i,"class","input"),x(v,"class","dropdown"),x(w,"class","form"),x(r,"class","cli"),x(n,"id","clui-fragment")},m(e,s){u(e,n,s),l(n,r),l(r,i),l(i,o),l(i,a),l(i,h),M(h,t[4]),l(r,g),l(r,v);for(let t=0;t<L.length;t+=1)L[t].m(v,null);l(r,b),l(r,w),_||(k=[y(h,"input",t[8]),y(h,"keydown",t[6]),y(h,"keyup",t[5]),y(h,"focus",t[9]),y(h,"blur",t[10])],_=!0)},p(t,[e]){if(16&e&&h.value!==t[4]&&M(h,t[4]),135&e){let n;for($=t[1],n=0;n<$.length;n+=1){const r=zt(t,$,n);L[n]?L[n].p(r,e):(L[n]=Ut(r),L[n].c(),L[n].m(v,null))}for(;n<L.length;n+=1)L[n].d(1);L.length=$.length}},i:e,o:e,d(t){t&&d(n),f(L,t),_=!1,s(k)}}}function Ht(t,e,n){const r=new qt;window.clui=r,r.load(...z);let s=[],i=[],o=[],c=0,a=!1,h="";const l=t=>i=t.filter((t=>!t.unknown)),u=()=>{h?(n(0,s=r.parseMatch(h)),l(s),n(1,o=r.search(i[0]&&i[0]instanceof Rt?i[0]:r,h,!0))):a&&n(1,o=r.commands)},d=(t,e)=>{Array.isArray(e)||(e=[e]);const r=t.findIndex((t=>t.unknown));-1!==r?t.splice(r,1,...e):t.push(...e),n(4,h=f(t)+" "),u()},f=t=>t.map((t=>t instanceof Rt?t.name:t.value)).join(" ");return t.$$.update=()=>{1&t.$$.dirty&&l(s)},[s,o,c,a,h,u,t=>{switch(t.key){case"ArrowDown":n(2,c=Math.min(c+1,o.length-1));break;case"ArrowUp":n(2,c=Math.max(c-1,0));break;case"Tab":t.preventDefault(),d(s,o[c].path||o[c])}},d,function(){h=this.value,n(4,h)},t=>{n(3,a=!0),u()},t=>{n(3,a=!1),u()},t=>n(2,c=t),t=>d(s,t.path||t)]}class Jt extends q{constructor(t){super(),this.shadowRoot.innerHTML="<style>#clui-fragment,#clui-fragment *{box-sizing:border-box}#clui-fragment{--dark:hsl(225, 32%, 13%);--darker:hsl(225, 35%, 9%);--darkest:hsl(225, 38%, 6%);--light:hsl(225, 35%, 36%);--medium:hsl(225, 31%, 18%);--text-light:hsl(225, 54%, 89%);--text-medium:hsl(225, 33%, 64%);background-color:var(--darkest);color:var(--text-medium);font-size:1.3rem;font-family:Calibri, sans-serif}#clui-fragment{display:flex;flex-direction:column;align-items:center;margin:0 auto}.input{position:relative;display:flex;align-items:center;border:2px solid var(--medium);border-radius:3px 3px 0 0;background-color:var(--dark)}.input>input{position:relative;z-index:1;flex:1;padding:0.6rem 0.4rem;outline:none;border:none;background-color:transparent;color:var(--text-light);font-size:inherit;font-family:Calibri, sans-serif}.dropdown{overflow-y:auto;min-width:40vw;max-width:60vw;max-height:40vh;border-radius:0 0 3px 3px;background-color:var(--darker)}.dropdown-item{position:relative;z-index:1;padding:0.3rem 0.6rem;padding-left:1.6rem;border-radius:3px;background-color:var(--darker)}.dropdown-item.selected{outline:2px solid var(--light);outline-offset:-2px;background-color:var(--light);background-color:var(--medium);color:var(--text-light);cursor:pointer}.item-name{margin-right:0.3rem;padding:0.3rem 0.5rem;border:2px solid var(--light);border-radius:3px;display:inline-block}.selected>.item-name{background-color:var(--light)}</style>",N(this,{target:this.shadowRoot,props:b(this.attributes),customElement:!0},Ht,Wt,o,{}),t&&t.target&&u(t.target,this,t.anchor)}}return customElements.define("clui-main",Jt),t.Clui=Jt,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=clui.js.map
